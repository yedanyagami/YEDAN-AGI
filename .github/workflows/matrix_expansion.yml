name: YEDAN-LEVIATHAN Expansion

on:
  schedule:
    - cron: "*/20 * * * *"
  workflow_dispatch:

permissions:
  contents: write
  issues: write

jobs:
  legion-attack:
    name: Legion Unit
    runs-on: ubuntu-latest
    strategy:
      fail-fast: false
      matrix:
        task: [btc_scan, sol_scan, eth_scan, wallet_guard, genesis_mind]

    steps:
    - name: Clone Repository
      uses: actions/checkout@v4
      with:
        token: ${{ secrets.GITHUB_TOKEN }}

    - name: Setup Python
      uses: actions/setup-python@v5
      with:
        python-version: "3.10"

    - name: Install Dependencies
      run: |
        pip install requests redis google-generativeai imap-tools playwright
        playwright install chromium

    - name: Execute Mission
      env:
        REDIS_URL: ${{ secrets.REDIS_URL }}
        GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
        GMAIL_USERNAME: ${{ secrets.GMAIL_USERNAME }}
        GMAIL_PASSWORD: ${{ secrets.GMAIL_PASSWORD }}
        GH_PAT: ${{ secrets.GITHUB_TOKEN }}
        TARGET_TASK: ${{ matrix.task }}
      run: |
        echo "ðŸš€ Unit ${{ matrix.task }} Launching..."
        if [ "$TARGET_TASK" == "wallet_guard" ]; then
            if [ -f yedan_wallet.py ]; then python yedan_wallet.py; else echo "Wallet script missing"; fi
        elif [ "$TARGET_TASK" == "genesis_mind" ]; then
            if [ -f main.py ]; then python main.py || true; else echo "Main brain missing"; fi
        else
            if [ -f antigravity_browser.py ]; then python antigravity_browser.py; else echo "Browser script missing"; fi
        fi
