name: YEDAN-LEVIATHAN Expansion

on:
  schedule:
    - cron: '*/20 * * * *' # æ¯ 20 åˆ†é˜åŸ·è¡Œä¸€æ¬¡
  workflow_dispatch:       # å…è¨±æ‰‹å‹•æŒ‰éˆ•è§¸ç™¼

permissions:
  contents: write
  issues: write

jobs:
  legion-attack:
    name: Legion Unit
    runs-on: ubuntu-latest
    strategy:
      fail-fast: false
      matrix:
        # å®šç¾© 5 å€‹åˆ†èº«ä»»å‹™
        task: [btc_scan, sol_scan, eth_scan, wallet_guard, genesis_mind]

    steps:
    - name: ğŸ“¥ ä¸‹è¼‰å¤§è…¦
      uses: actions/checkout@v4
      with:
        token: ${{ secrets.GH_PAT }}

    - name: ğŸ æ³¨å…¥ç¥ç¶“
      uses: actions/setup-python@v5
      with:
        python-version: '3.10'

    - name: ğŸ“¦ æ­¦è£è¨­å‚™
      run: |
        pip install requests redis google-generativeai imap-tools playwright
        playwright install chromium

    - name: âš”ï¸ åŸ·è¡Œä»»å‹™: ${{ matrix.task }}
      env:
        REDIS_URL: ${{ secrets.REDIS_URL }}
        GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
        GMAIL_USERNAME: ${{ secrets.GMAIL_USERNAME }}
        GMAIL_PASSWORD: ${{ secrets.GMAIL_PASSWORD }}
        TARGET_TASK: ${{ matrix.task }}
      run: |
        echo "ğŸš€ Unit ${{ matrix.task }} å•Ÿå‹•..."
        
        if [ "$TARGET_TASK" == "wallet_guard" ]; then
            python yedan_wallet.py
        elif [ "$TARGET_TASK" == "genesis_mind" ]; then
            # å¦‚æœ main.py é‚„æ²’ä¿®å¾©ï¼Œé€™è£¡å¯èƒ½æœƒå ±éŒ¯ï¼Œä½†ä¸æœƒå½±éŸ¿å…¶ä»–åˆ†èº«
            python main.py || echo "Main brain maintenance"
        else
            # æƒæä»»å‹™ä½¿ç”¨ Antigravity
            python antigravity_browser.py
        fi
