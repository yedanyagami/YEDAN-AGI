name: YEDAN-LEVIATHAN Expansion

on:
  schedule:
    - cron: "*/20 * * * *"
  workflow_dispatch:

# çµ¦äºˆæœ€é«˜æ¬Šé™ï¼Œä¸å†å•æ‚¨å¯†ç¢¼
permissions:
  contents: write
  issues: write
  pull-requests: write

jobs:
  legion-attack:
    name: Legion Unit
    runs-on: ubuntu-latest
    strategy:
      fail-fast: false
      matrix:
        task: [btc_scan, sol_scan, eth_scan, wallet_guard, genesis_mind]

    steps:
    - name: Clone Repository
      uses: actions/checkout@v4
      with:
        # ä½¿ç”¨å…§å»ºé‡‘é‘°ï¼Œä¿è­‰é€šé
        token: ${{ secrets.GITHUB_TOKEN }}

    - name: Setup Python
      uses: actions/setup-python@v5
      with:
        python-version: "3.10"

    - name: Install Weapons
      run: |
        pip install requests redis google-generativeai imap-tools playwright
        playwright install chromium

    - name: Execute Mission
      env:
        # è‡ªå‹•æ›è¼‰æ‰€æœ‰æ‚¨å·²ç¶“è¨­å®šå¥½çš„ç§˜å¯†
        REDIS_URL: ${{ secrets.REDIS_URL }}
        GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
        GMAIL_USERNAME: ${{ secrets.GMAIL_USERNAME }}
        GMAIL_PASSWORD: ${{ secrets.GMAIL_PASSWORD }}
        TARGET_TASK: ${{ matrix.task }}
      run: |
        echo "ğŸš€ Unit ${{ matrix.task }} å…¨è‡ªå‹•å•Ÿå‹•..."
        if [ "$TARGET_TASK" == "wallet_guard" ]; then
            if [ -f yedan_wallet.py ]; then python yedan_wallet.py; else echo "Wallet module missing"; fi
        elif [ "$TARGET_TASK" == "genesis_mind" ]; then
            if [ -f main.py ]; then python main.py || true; else echo "Brain module missing"; fi
        else
            if [ -f antigravity_browser.py ]; then python antigravity_browser.py; else echo "Browser module missing"; fi
        fi
